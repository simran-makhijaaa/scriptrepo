name: learn-github-actions
run-name: database
on: push 
jobs:
  container-job:
    runs-on: ubuntu-latest
    container: node:10.18-jessie
    services:
      postgres:
        image: postgres
    
    steps:  
     - name: get version
         id: version
         uses: notiz-dev/github-action-json-property@release
         with: 
            path: 'package.json'
            prop_path: 'version'
    -  run: echo ${{steps.version.outputs.prop}} 

      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Install dependencies
        run: npm ci
      - name: Connect to PostgreSQL
        run: node client.js
        env:
          POSTGRES_HOST: postgres
          POSTGRES_PORT: 5432
